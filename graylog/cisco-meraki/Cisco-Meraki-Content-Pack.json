{
  "v": 1,
  "id": "a43f64e8-30e5-4cc5-8128-9cf8ff9fa4b9",
  "rev": 1,
  "name": "Cisco Meraki",
  "summary": "Takes in raw Cisco Meraki Logs and extracts the fields. Uses port 1514",
  "description": "Receives Cisco Meraki syslogs and extracts the various fields then converts them in a separate stream to the appropriate field type and then sends them back to the original stream to keep the stream pipelines clean. The \"Meraki - UNIX Epoch Conversion with Timezone\" will need to be edited. Change \"America/Los_Angeles\" to the appropriate timezone for your location. View the GitHub instructions.md file for more information like adding the lookup tables, etc.",
  "vendor": "kbrown900",
  "url": "https://github.com/kbrown900/Templates/blob/main/graylog/cisco-meraki/Cisco-Meraki-Content-Pack.json",
  "parameters": [],
  "entities": [
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "a46fd244-c92d-4b5d-98bf-c6c205f1ea33",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - protocol"
        },
        "description": {
          "@type": "string",
          "@value": "Converts the protocol number to its IANA IP description and removes duplicate field. "
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - protocol\"\nwhen\n  has_field(\n    field : \"meraki_protocol_number\"\n  )\nthen\n  let output_1 = get_field(\n    field : \"meraki_protocol_number\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_protocol_number\",\n    value : output_2\n  );\n  let gl2_fragment_extractor_1743547759943 = lookup_value(\"Meraki - protocol\", to_string($message.\"meraki_protocol_number\"));\nset_field(\"meraki_protocol_descripton\", gl2_fragment_extractor_1743547759943);\n  let output_3 = gl2_fragment_extractor_1743547759943;\n  remove_single_field(\n    field : \"meraki_protocol_number\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "bcdf98e0-cf5e-496f-a186-cc1b50c0e4e8",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - vlan"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - vlan\"\nwhen\n  has_field(\n    field : \"meraki_vlan\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_vlan\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"vlan\",\n    value : output_2,\n    prefix : \"meraki_\"\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "event_definition",
        "version": "1"
      },
      "id": "7af3d00b-3e52-412f-b700-10dbb3d12bdc",
      "data": {
        "field_spec": {},
        "config": {
          "query_parameters": [],
          "search_within_ms": 300000,
          "query": {
            "@type": "string",
            "@value": "meraki_event_type:\"martian_vlan\""
          },
          "cron_expression": null,
          "cron_timezone": null,
          "use_cron_scheduling": false,
          "streams": [],
          "execute_every_ms": 60000,
          "event_limit": 100,
          "group_by": [],
          "series": [
            {
              "type": "count",
              "id": "count-meraki_event_type",
              "field": "meraki_event_type"
            }
          ],
          "conditions": {
            "expression": {
              "expr": ">=",
              "left": {
                "expr": "number-ref",
                "ref": "count-meraki_event_type"
              },
              "right": {
                "expr": "number",
                "value": 5
              }
            }
          },
          "type": "aggregation-v1",
          "stream_categories": [],
          "filters": []
        },
        "priority": {
          "@type": "integer",
          "@value": 2
        },
        "notifications": [],
        "remediation_steps": null,
        "matched_at": "2025-04-10T17:05:44.338Z",
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "notification_settings": {
          "grace_period_ms": 300000,
          "backlog_size": 0
        },
        "updated_at": "2025-03-28T22:19:43.936Z",
        "title": {
          "@type": "string",
          "@value": "Meraki - Martian VLAN Detection"
        },
        "is_scheduled": {
          "@type": "boolean",
          "@value": true
        },
        "key_spec": [],
        "storage": [
          {
            "type": "persist-to-streams-v1",
            "streams": [
              "000000000000000000000002"
            ]
          }
        ],
        "alert": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "Triggers an alert when a martian_vlan event is detected from a device."
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "4f307cce-968c-4c51-b648-8dcd87a3fcb6",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - ip_src"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - ip_src\"\nwhen\n  has_field(\n    field : \"meraki_ip_src\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\"\n  );\n  let output_1 = get_field(\n    field : \"meraki_ip_src\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_ip_src\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "842fd781-b7e9-4fb6-9294-88e441db393f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Airmarshal Events"
        },
        "description": {
          "@type": "string",
          "@value": "Parses out logs that contain airmarshal_events"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Airmarshal Events\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"airmarshal_events\"\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"type='%{WORD:airmarshal_event_type}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"ssid='%{DATA:ssid}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"bssid='%{COMMONMAC:bssid}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"src='%{COMMONMAC:src_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dst='%{COMMONMAC:dst_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"wired_mac='%{COMMONMAC:wired_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"vlan_id='%{DATA:vlan_id}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"channel='%{BASE10NUM:channel}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"rssi='%{BASE10NUM:rssi}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"fc_type='%{BASE10NUM:fc_type}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"fc_subtype='%{BASE10NUM:fc_subtype}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "9835e5e7-80da-4d72-abe5-122a6f50f191",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - full_conn_time"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - full_conn_time\"\nwhen\n  has_field(\n    field : \"meraki_full_conn_time\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_full_conn_time\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_full_conn_time\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "3ad15f3f-1661-4685-9b15-05fb97ee33c4",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "facility-mapping"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - Facility Mapping"
        },
        "description": {
          "@type": "string",
          "@value": "Maps Meraki Facility to its actuals"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/facility.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "event_definition",
        "version": "1"
      },
      "id": "04e179ff-fea5-4d48-92ac-64f9b22aa227",
      "data": {
        "field_spec": {},
        "config": {
          "query_parameters": [],
          "search_within_ms": 600000,
          "query": {
            "@type": "string",
            "@value": "meraki_reason_description:\"Security disabled\""
          },
          "cron_expression": null,
          "cron_timezone": null,
          "use_cron_scheduling": false,
          "streams": [
            "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
          ],
          "execute_every_ms": 600000,
          "event_limit": 5,
          "group_by": [],
          "series": [],
          "conditions": {
            "expression": null
          },
          "type": "aggregation-v1",
          "stream_categories": [],
          "filters": []
        },
        "priority": {
          "@type": "integer",
          "@value": 2
        },
        "notifications": [],
        "remediation_steps": null,
        "matched_at": "2025-03-31T15:40:49.562Z",
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "notification_settings": {
          "grace_period_ms": 300000,
          "backlog_size": 0
        },
        "updated_at": "2025-03-31T16:00:59.706Z",
        "title": {
          "@type": "string",
          "@value": "Meraki - Reason Failures"
        },
        "is_scheduled": {
          "@type": "boolean",
          "@value": true
        },
        "key_spec": [],
        "storage": [
          {
            "type": "persist-to-streams-v1",
            "streams": [
              "000000000000000000000002"
            ]
          }
        ],
        "alert": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "Checks for reason codes of Security Disabled."
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "54df3ef7-121d-430c-80bd-b20363f5522a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dst_ip"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dst_ip\"\nwhen\n  has_field(\n    field : \"meraki_dst_ip\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_dst_ip\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_dst_ip\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "0603c9a5-0a06-4d0c-9fc8-ab78fc6e1a64",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - client_ip"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - client_ip\"\nwhen\n  has_field(\n    field : \"meraki_client_ip\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_client_ip\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_client_ip\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "141e796e-62ac-457f-ab59-579973b70064",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - server_ip"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - server_ip\"\nwhen\n  has_field(\n    field : \"meraki_server_ip\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_server_ip\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_server_ip\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "289b1690-9b00-47e3-b8f4-235414ef0cd8",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - vap"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - vap\"\nwhen\n  has_field(\n    field : \"meraki_vap\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_vap\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_vap\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1388e857-2a15-425d-b499-2894563b0f4b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dst_port"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dst_port\"\nwhen\n  has_field(\n    field : \"meraki_dst_port\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_dst_port\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_dst_port\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "6e570a5a-0b0c-4e1b-a33f-1ea876d4dc93",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dhcp_lease_completed"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dhcp_lease_completed\"\nwhen\n  has_field(\n    field : \"meraki_dhcp_lease_completed\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_dhcp_lease_completed\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_dhcp_lease_completed\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "31b84e34-6afe-4eb9-9198-6b8257168a72",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - icmp6_type"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - icmp6_type"
        },
        "description": {
          "@type": "string",
          "@value": "Data adapter for meraki icmp6 type"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/icmp6_type.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "0a2e9d4d-63f4-4ff8-a28e-c4d0ad99cce4",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - UNIX Epoch Conversion with Timezone"
        },
        "description": {
          "@type": "string",
          "@value": "Converts UNIX timestamp from log to human readable. "
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - UNIX Epoch Conversion with Timezone\"\nwhen\n  has_field(\"meraki_epoch\")\nthen\n  // Step 1: Get raw epoch value as string\n  let raw_epoch_str = to_string(get_field(\"meraki_epoch\"));\n  //set_field(\"debug_raw_epoch_str\", raw_epoch_str);\n\n  // Step 2: Convert to floating-point number to handle decimals\n  let raw_epoch = to_double(raw_epoch_str);\n  //set_field(\"debug_raw_epoch\", raw_epoch);\n\n  // Step 3: Drop the decimal part and convert to whole seconds (round down)\n  let epoch_seconds = to_long(raw_epoch);  // Dropping the fractional part\n  //set_field(\"debug_epoch_seconds\", epoch_seconds);\n\n  // Step 4: Convert the epoch seconds to milliseconds\n  let epoch_ms = epoch_seconds * 1000;  // Convert to milliseconds\n  //set_field(\"debug_epoch_ms\", epoch_ms);\n\n  // Step 5: Use parse_unix_milliseconds to convert the epoch timestamp (milliseconds) to a date\n  let converted_date = parse_unix_milliseconds(epoch_ms, \"America/Los_Angeles\");\n // set_field(\"debug_converted_date_tz\", converted_date);\n\n  // Step 6: Store the correctly parsed and timezone-adjusted timestamp\n  set_field(\"meraki_timestamp\", converted_date);\nend\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "802aa051-8c72-4adc-a862-338192b22134",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - icmp6_type"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "31b84e34-6afe-4eb9-9198-6b8257168a72"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - icmp6_type"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Lookup table for converting icmp6_type to its description."
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "c37b5acf-3b8a-4b49-aca5-eac50be5eaed",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - best_ap_load"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - best_ap_load\"\nwhen\n  has_field(\n    field : \"meraki_best_ap_load\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_best_ap_load\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_best_ap_load\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "d2280139-ddc8-4ee5-8564-2116967d0483",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - IDS Alerts"
        },
        "description": {
          "@type": "string",
          "@value": "Parses IDS Alert Logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - IDS Alerts\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"ids-alerts\",\n  ignore_case: true\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{DATA:category} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"signature=%{DATA:signature} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"priority=%{BASE10NUM:priority} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"timestamp=%{BASE10NUM:event_epoch}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"direction=%{WORD:direction}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"protocol=%{DATA:protocol} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"src=%{IPV4:src_ip}:%{INT:src_port}|src=%{IPV6:src_ip}:%{INT:src_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  set_field(\n    field : \"issue\",\n    value : \"IDS Alert\",\n    prefix : \"meraki_\"\n  );\n  remove_single_field(\n    field : \"meraki_IP\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "2e8aa85f-eccb-4e5b-941d-d6b35f5fe0a0",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - protocol"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - protocol"
        },
        "description": {
          "@type": "string",
          "@value": "Data adapter for meraki protocol type"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/protocol.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "d1383e34-9221-4f28-a988-4c7dc6b195b1",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - Two MACs Same IP"
        },
        "description": {
          "@type": "string",
          "@value": "Parses issues of two macs claiming the same IP address"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - Two MACs Same IP\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"events MAC \"\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"events MAC %{COMMONMAC:mac1} and MAC %{COMMONMAC:mac2} both claim IP: %{IP:claimed_ip}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  set_field(\n    field : \"meraki_issue\",\n    value : \"Two MACs claim single IP\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1523a421-9373-499f-a511-ec2736a022ec",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - Content Filtering"
        },
        "description": {
          "@type": "string",
          "@value": "Parses event logs based around content filtering"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - Content Filtering\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"content_filtering\"\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category} %{WORD:filter_action}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"url='%{URI:url}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"server='%{IP:server}:%{BASE10NUM:server_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"client_ip='%{IP:client_ip}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"category0='%{DATA:filter_reason}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"category1='%{DATA:filter_subreason}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  rename_field(\n    old_field : \"meraki_HOSTNAME\",\n    new_field : \"meraki_url_hostname\"\n  );\n  rename_field(\n    old_field : \"meraki_IPORHOST\",\n    new_field : \"meraki_url_iporhost\"\n  );\n  rename_field(\n    old_field : \"meraki_URIHOST\",\n    new_field : \"meraki_url_urihost\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPATH\",\n    new_field : \"meraki_url_path\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPATHPARAM\",\n    new_field : \"meraki_url_uripathparam\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPROTO\",\n    new_field : \"meraki_url_protocol\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "e2b262d4-8b83-4a7d-b0c8-acf97f5d59ac",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - FC Combined"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - FC Combined"
        },
        "description": {
          "@type": "string",
          "@value": "Combined frame control data."
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/fc_combined.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1e10610a-7ab0-4ff2-83b6-a6b71a465d88",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - icmp6_type"
        },
        "description": {
          "@type": "string",
          "@value": "Converts ICMP6 to its human readable description. "
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - icmp6_type\"\nwhen\n  contains(\n  value: to_string($message.\"meraki_protocol\"),\n  search: \"icmp6\",\n  ignore_case: true\n)\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_icmp_type\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_icmp_type\",\n    value : output_2\n  );\n  let gl2_fragment_extractor_1743543348834 = lookup_value(\"Meraki - icmp6_type\", to_string($message.\"meraki_icmp_type\"));\nset_field(\"meraki_icmp_type_description\", gl2_fragment_extractor_1743543348834);\n  let output_3 = gl2_fragment_extractor_1743543348834;\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "71427650-de3b-4a40-8eda-0a8fa033d6e6",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dns_resp_time"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dns_resp_time\"\nwhen\n  has_field(\n    field : \"meraki_dns_resp_time\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_dns_resp_time\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_dns_resp_time\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2c74de2e-fab3-46a2-9291-f925a5075293",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - rssi_signal_strength "
        },
        "description": {
          "@type": "string",
          "@value": "Converts rssi to signal strength in dB."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - rssi_signal_strength \"\nwhen\n    has_field(\"meraki_rssi\")\nthen\n  let rssi = to_long($message.meraki_rssi);\n  let signal_strength = rssi - 95;\n  set_field(\"meraki_signal_strength_db\", signal_strength);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "79997644-4820-45b5-b2f4-fd5a8ca998eb",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - arp_resp_time"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - arp_resp_time\"\nwhen\n  has_field(\n    field : \"meraki_arp_resp_time\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_arp_resp_time\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_arp_resp_time\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5f456d80-436c-4422-aa8c-297ffe05abc9",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - rssi"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - rssi\"\nwhen\n  has_field(\n    field : \"meraki_rssi\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_rssi\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_rssi\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "40430ed6-1fa3-434e-97b4-34950ddfc2d1",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki Facility Mapping"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "3ad15f3f-1661-4685-9b15-05fb97ee33c4"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - Facility Mapping"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Mapping Facility for meraki"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "3ba93118-b809-49b9-b5a0-7071e79e3f0d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - FIPS Event"
        },
        "description": {
          "@type": "string",
          "@value": "Parses FIPS events."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - FIPS Event\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"type=fips_event\",\n  ignore_case: true\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"type=%{WORD:event_type}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"reason='%{DATA:fips_reason}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "9cb5e1ff-3012-4eea-a3a4-f407b1201af4",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - Port Status Change"
        },
        "description": {
          "@type": "string",
          "@value": "Parses logs referencing Port Status Changes"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - Port Status Change\"\nwhen\n  grok(\n  value: to_string($message.\"message\"),\n  pattern: \"port %{BASE10NUM:port} status changed \"\n).matches == true\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"port %{BASE10NUM:switch_port} status changed from %{DATA:old_status} to %{GREEDYDATA:new_status}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  set_field(\n    field : \"issue\",\n    value : \"Port Status Change\",\n    prefix : \"meraki_\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "e095888d-1483-43a9-bf12-74a893d62404",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - ip_resp_time"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - ip_resp_time\"\nwhen\n  has_field(\n    field : \"meraki_ip_resp_time\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_ip_resp_time\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_ip_resp_time\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "cbcddb5a-03a6-4147-ac13-aed75dfea7e0",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dhcp_server"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dhcp_server\"\nwhen\n  has_field(\n    field : \"meraki_dhcp_server\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\"\n  );\n  let output_1 = get_field(\n    field : \"meraki_dhcp_server\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_dhcp_server\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "77ab04ec-0977-4c66-8744-e251a6364a73",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - icmp_type"
        },
        "description": {
          "@type": "string",
          "@value": "Converts ICMP codes to human readable"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - icmp_type\"\nwhen\n  has_field(\n    field : \"meraki_icmp_type\"\n  )\n  AND\n  ! contains(\n  value: to_string($message.\"meraki_protocol\"),\n  search: \"icmp6\",\n  ignore_case: true\n)\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_icmp_type\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_icmp_type\",\n    value : output_2\n  );\n  let gl2_fragment_extractor_1743543348834 = lookup_value(\"Meraki - icmp_type\", to_string($message.\"meraki_icmp_type\"));\nset_field(\"meraki_icmp_type_description\", gl2_fragment_extractor_1743543348834);\n  let output_3 = gl2_fragment_extractor_1743543348834;\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "4c426b3c-1bfa-4b89-8a00-0b92c9b05117",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "syslog-severity-mapping"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - Syslog Severity Mapping"
        },
        "description": {
          "@type": "string",
          "@value": "Maps Meraki Syslog Severity to its actuals"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/syslog_severity_mapping.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "799d61cd-d9e6-4a75-80fe-ec6af5956314",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - load"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - load\"\nwhen\n  has_field(\n    field : \"meraki_load\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_load\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"load\",\n    value : output_2,\n    prefix : \"meraki_\"\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "fe2c66d4-6514-4a76-b89d-2cba23e99258",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - aid"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - aid\"\nwhen\n  has_field(\n    field : \"meraki_aid\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_aid\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_aid\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "90aaa211-f39b-4b22-99a4-f592a97036c3",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dhcp_ip"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dhcp_ip\"\nwhen\n  has_field(\n    field : \"meraki_dhcp_ip\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_dhcp_ip\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_dhcp_ip\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "fda03bad-cc77-4be9-892a-eb9724508e31",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "meraki-wpa"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - WPA"
        },
        "description": {
          "@type": "string",
          "@value": "Converts 0 or 1 to human readable. "
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/is_wpa.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "ec7b4086-94be-4e7f-bcc8-fd44dfb70327",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - FC Combined"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "e2b262d4-8b83-4a7d-b0c8-acf97f5d59ac"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - FC Combined"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Maps the frame control type and subtype"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "input",
        "version": "1"
      },
      "id": "a0da9a6c-622a-45eb-a825-91cf5d01dbea",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Cisco Meraki"
        },
        "configuration": {
          "recv_buffer_size": {
            "@type": "integer",
            "@value": 262144
          },
          "port": {
            "@type": "integer",
            "@value": 1514
          },
          "number_worker_threads": {
            "@type": "integer",
            "@value": 10
          },
          "charset_name": {
            "@type": "string",
            "@value": "UTF-8"
          },
          "bind_address": {
            "@type": "string",
            "@value": "0.0.0.0"
          }
        },
        "static_fields": {},
        "type": {
          "@type": "string",
          "@value": "org.graylog2.inputs.raw.udp.RawUDPInput"
        },
        "global": {
          "@type": "boolean",
          "@value": true
        },
        "extractors": []
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "ec012a41-9c14-49d7-8142-3cb7b0c64e1f",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "meraki-reason"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - reason"
        },
        "description": {
          "@type": "string",
          "@value": "Data adapter for meraki reason"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/reason.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "2e71c2af-5711-47bd-92df-609827d9f92e",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - priority"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "de6f6189-bff7-4f18-b11a-d101c1e0874f"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - priority"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Lookup table for snort priority table"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "dashboard",
        "version": "2"
      },
      "id": "158f5ea7-599b-4950-a313-aa40c7f21e5e",
      "data": {
        "summary": {
          "@type": "string",
          "@value": "Meraki logs"
        },
        "search": {
          "queries": [
            {
              "id": "3ce0f07f-aff7-4e8a-a2ae-91875b183dde",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count(meraki_airmarshal_event_type)",
                      "field": "meraki_airmarshal_event_type"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "meraki_airmarshal_event_type"
                      ],
                      "limit": 15,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "f54aeec0-204d-4044-8ac1-24a7a2bae0e7",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count(meraki_action_taken)",
                      "field": "meraki_action_taken"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "meraki_action_taken"
                      ],
                      "limit": 15,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "6ebab2fb-4c1f-49ea-b047-1cc449686176",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count(meraki_syslog_severity)",
                      "field": "meraki_syslog_severity"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "meraki_syslog_severity"
                      ],
                      "limit": 15,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "3efbec63-2c60-46e4-9a77-0d4be57e4a0c",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 3600,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "avg",
                      "id": "DHCP Response Time",
                      "field": "meraki_dhcp_resp_time",
                      "whole_number": false
                    },
                    {
                      "type": "avg",
                      "id": "DNS Round Trip Time",
                      "field": "meraki_dns_req_rtt_time",
                      "whole_number": false
                    },
                    {
                      "type": "avg",
                      "id": "DNS Response Time",
                      "field": "meraki_dns_resp_time",
                      "whole_number": false
                    },
                    {
                      "type": "avg",
                      "id": "DNS Req Round Trip Time",
                      "field": "meraki_dns_req_rtt_time",
                      "whole_number": false
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "time",
                      "fields": [
                        "timestamp"
                      ],
                      "interval": {
                        "type": "auto",
                        "scaling": 1
                      }
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "d9a8929b-f250-46c2-b237-81224a334b06",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count(meraki_category)",
                      "field": "meraki_category"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "meraki_category"
                      ],
                      "limit": 15,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "00856c7e-5473-4bb8-983a-c390b1870568",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "count(meraki_event_type)",
                      "field": "meraki_event_type"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "meraki_event_type"
                      ],
                      "limit": 15,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "a5651760-2c57-4993-9e7d-934cab147297",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            },
            {
              "id": "68d83277-6b5f-401d-86cf-7df864fd8ecf",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "meraki_filter_action:content_filtering_block"
                  },
                  "name": null,
                  "timerange": {
                    "range": 0,
                    "type": "relative"
                  },
                  "offset": 0,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "stream_categories": [],
                  "id": "4242de24-d0eb-4795-85d3-c3a19b99736e",
                  "limit": 150,
                  "filters": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "meraki_filter_action:content_filtering_block"
                  },
                  "name": "chart",
                  "timerange": {
                    "range": 0,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Total Hits",
                      "field": "meraki_url"
                    },
                    {
                      "type": "percentage",
                      "id": "Percentage of Total",
                      "strategy": "COUNT",
                      "field": "meraki_url"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "meraki_url",
                        "meraki_filter_reason"
                      ],
                      "limit": 25,
                      "skip_empty_values": false
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "12a1cac0-eb74-45d2-b91d-e850d81272b2",
                  "filters": [],
                  "column_groups": [],
                  "sort": [
                    {
                      "type": "series",
                      "field": "count(meraki_url)",
                      "direction": "Descending"
                    }
                  ]
                }
              ]
            },
            {
              "id": "40774a0d-c721-414f-bae8-5473bdc891bd",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "count",
                      "id": "Total Issues",
                      "field": "meraki_issue"
                    },
                    {
                      "type": "percentage",
                      "id": "Percentage of Total",
                      "strategy": "COUNT",
                      "field": "meraki_issue"
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "meraki_issue"
                      ],
                      "limit": 15,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "0a7358ad-70ed-49a3-bc42-b0c3283db5cb",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                },
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": "meraki_event_type:\"martian_vlan\""
                  },
                  "name": null,
                  "timerange": {
                    "from": 86400,
                    "type": "relative"
                  },
                  "offset": 0,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "filter": null,
                  "decorators": [],
                  "type": "messages",
                  "stream_categories": [],
                  "id": "d13cd07d-4419-45bd-aec2-6f9b41098c30",
                  "limit": 150,
                  "filters": []
                }
              ]
            },
            {
              "id": "c650fdda-5500-4885-bf0b-43c93273e86b",
              "timerange": {
                "from": 300,
                "type": "relative"
              },
              "filters": [],
              "query": {
                "type": "elasticsearch",
                "query_string": ""
              },
              "search_types": [
                {
                  "query": {
                    "type": "elasticsearch",
                    "query_string": ""
                  },
                  "name": "chart",
                  "timerange": {
                    "from": 300,
                    "type": "relative"
                  },
                  "column_limit": null,
                  "streams": [
                    "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                  ],
                  "row_limit": null,
                  "series": [
                    {
                      "type": "avg",
                      "id": "Signal Strength",
                      "field": "meraki_signal_strength_db",
                      "whole_number": false
                    },
                    {
                      "type": "avg",
                      "id": "Best AP Signal Strength",
                      "field": "meraki_best_ap_signal_strength_db",
                      "whole_number": false
                    }
                  ],
                  "filter": null,
                  "rollup": true,
                  "row_groups": [
                    {
                      "type": "values",
                      "fields": [
                        "meraki_host"
                      ],
                      "limit": 15,
                      "skip_empty_values": true
                    }
                  ],
                  "type": "pivot",
                  "stream_categories": [],
                  "id": "5fac8ad0-8558-463f-93e8-8b1a5fdee633",
                  "filters": [],
                  "column_groups": [],
                  "sort": []
                }
              ]
            }
          ],
          "parameters": [],
          "requires": {},
          "owner": "kbrown",
          "created_at": "2025-04-10T17:37:43.716Z"
        },
        "created_at": "2025-03-19T20:21:35.428Z",
        "requires": {},
        "state": {
          "3ce0f07f-aff7-4e8a-a2ae-91875b183dde": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "587ef1cf-6886-413e-b074-f0ee26f6cb46": "Message Table",
                "dff65622-c6e3-455e-b341-1f7ed61e90f6": "DNS Req R",
                "32ba85ea-086b-4f23-a22d-b0cfa80db88b": "Event Actions Taken",
                "14bba717-5b3b-40f8-a191-ee744a4b78e4": "Event Types",
                "be46012b-04cb-4d05-8b87-2620c9895781": "Syslog Facility and Priority",
                "0044022b-1bbe-488a-a366-77a24eae572f": "Events by Category",
                "b242c0a2-cca0-4564-a53d-9ba2e4f8a8b0": "Syslog Severity",
                "4b86c586-6824-4308-8fc3-fa932dedc433": "Airmarshal Events",
                "3bfdb11b-cfac-4110-9af0-9706f53f35bc": "Avg DHCP Response Time",
                "4e86be0a-5608-436b-b5b7-efe2e31eccc1": "Avg Response Times",
                "552e967d-f51a-47ac-bb5e-8015bdb4080a": " Message Count"
              },
              "tab": {
                "title": "Response Times and Events"
              }
            },
            "widgets": [
              {
                "config": {
                  "visualization": "pie",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "meraki_airmarshal_event_type"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count(meraki_airmarshal_event_type)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "4b86c586-6824-4308-8fc3-fa932dedc433",
                "filters": []
              },
              {
                "config": {
                  "visualization": "line",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": null,
                  "row_pivots": [
                    {
                      "fields": [
                        "timestamp"
                      ],
                      "type": "time",
                      "config": {
                        "interval": {
                          "type": "auto",
                          "scaling": 1
                        }
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "DHCP Response Time"
                      },
                      "function": "avg(meraki_dhcp_resp_time)"
                    },
                    {
                      "config": {
                        "name": "DNS Round Trip Time"
                      },
                      "function": "avg(meraki_dns_req_rtt_time)"
                    },
                    {
                      "config": {
                        "name": "DNS Response Time"
                      },
                      "function": "avg(meraki_dns_resp_time)"
                    },
                    {
                      "config": {
                        "name": "DNS Req Round Trip Time"
                      },
                      "function": "avg(meraki_dns_req_rtt_time)"
                    }
                  ],
                  "rollup": true,
                  "column_pivots": [],
                  "visualization_config": {
                    "interpolation": "linear",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "from": 3600,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "4e86be0a-5608-436b-b5b7-efe2e31eccc1",
                "filters": []
              },
              {
                "config": {
                  "visualization": "pie",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "meraki_syslog_severity"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count(meraki_syslog_severity)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "b242c0a2-cca0-4564-a53d-9ba2e4f8a8b0",
                "filters": []
              },
              {
                "config": {
                  "visualization": "pie",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "meraki_category"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count(meraki_category)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "0044022b-1bbe-488a-a366-77a24eae572f",
                "filters": []
              },
              {
                "config": {
                  "visualization": "pie",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "meraki_action_taken"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count(meraki_action_taken)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "32ba85ea-086b-4f23-a22d-b0cfa80db88b",
                "filters": []
              },
              {
                "config": {
                  "visualization": "pie",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "meraki_event_type"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": null
                      },
                      "function": "count(meraki_event_type)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": null,
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "14bba717-5b3b-40f8-a191-ee744a4b78e4",
                "filters": []
              }
            ],
            "widget_mapping": {
              "b242c0a2-cca0-4564-a53d-9ba2e4f8a8b0": [
                "3efbec63-2c60-46e4-9a77-0d4be57e4a0c"
              ],
              "4b86c586-6824-4308-8fc3-fa932dedc433": [
                "f54aeec0-204d-4044-8ac1-24a7a2bae0e7"
              ],
              "14bba717-5b3b-40f8-a191-ee744a4b78e4": [
                "a5651760-2c57-4993-9e7d-934cab147297"
              ],
              "4e86be0a-5608-436b-b5b7-efe2e31eccc1": [
                "d9a8929b-f250-46c2-b237-81224a334b06"
              ],
              "32ba85ea-086b-4f23-a22d-b0cfa80db88b": [
                "6ebab2fb-4c1f-49ea-b047-1cc449686176"
              ],
              "0044022b-1bbe-488a-a366-77a24eae572f": [
                "00856c7e-5473-4bb8-983a-c390b1870568"
              ]
            },
            "positions": {
              "32ba85ea-086b-4f23-a22d-b0cfa80db88b": {
                "col": 1,
                "row": 9,
                "height": 4,
                "width": 6
              },
              "14bba717-5b3b-40f8-a191-ee744a4b78e4": {
                "col": 7,
                "row": 1,
                "height": 4,
                "width": 6
              },
              "0044022b-1bbe-488a-a366-77a24eae572f": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 6
              },
              "b242c0a2-cca0-4564-a53d-9ba2e4f8a8b0": {
                "col": 7,
                "row": 9,
                "height": 4,
                "width": 6
              },
              "4b86c586-6824-4308-8fc3-fa932dedc433": {
                "col": 7,
                "row": 5,
                "height": 4,
                "width": 6
              },
              "4e86be0a-5608-436b-b5b7-efe2e31eccc1": {
                "col": 1,
                "row": 5,
                "height": 4,
                "width": 6
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          },
          "68d83277-6b5f-401d-86cf-7df864fd8ecf": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "2d67edd2-582a-417a-a615-9953bc361e8b": "Message Count",
                "5b82ceb1-b053-4107-b0fa-6bbfa7211268": "Issue Counts",
                "39b4f656-4031-44ec-80f9-b0b12ab830d1": "Dissassociation Reasons",
                "daa1e2da-4a33-40ec-b088-6c8c5c456011": "Blocked URLs",
                "ec34e501-78b2-4c3b-bcba-7a846bd96e17": "Top Blocked URL's"
              },
              "tab": {
                "title": "URLs"
              }
            },
            "widgets": [
              {
                "config": {
                  "fields": [
                    "timestamp",
                    "source"
                  ],
                  "units": {},
                  "show_message_row": true,
                  "show_summary": true,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "meraki_filter_action:content_filtering_block"
                },
                "timerange": {
                  "range": 0,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "messages",
                "stream_categories": [],
                "id": "daa1e2da-4a33-40ec-b088-6c8c5c456011",
                "filters": []
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 25,
                  "row_pivots": [
                    {
                      "fields": [
                        "meraki_url",
                        "meraki_filter_reason"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 25,
                        "skip_empty_values": false
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Total Hits"
                      },
                      "function": "count(meraki_url)"
                    },
                    {
                      "config": {
                        "name": "Percentage of Total"
                      },
                      "function": "percentage(meraki_url)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": [
                    {
                      "type": "series",
                      "field": "count(meraki_url)",
                      "direction": "Descending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "meraki_filter_action:content_filtering_block"
                },
                "timerange": {
                  "range": 0,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "ec34e501-78b2-4c3b-bcba-7a846bd96e17",
                "filters": []
              }
            ],
            "widget_mapping": {
              "ec34e501-78b2-4c3b-bcba-7a846bd96e17": [
                "12a1cac0-eb74-45d2-b91d-e850d81272b2"
              ],
              "daa1e2da-4a33-40ec-b088-6c8c5c456011": [
                "4242de24-d0eb-4795-85d3-c3a19b99736e"
              ]
            },
            "positions": {
              "daa1e2da-4a33-40ec-b088-6c8c5c456011": {
                "col": 1,
                "row": 5,
                "height": 4,
                "width": "Infinity"
              },
              "ec34e501-78b2-4c3b-bcba-7a846bd96e17": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          },
          "40774a0d-c721-414f-bae8-5473bdc891bd": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "widget": {
                "c10eb3e1-64a3-48d8-8916-625ec2f31fd8": "Issues Totals",
                "c62e0dec-744b-4fb7-8c4b-90454542836a": "Martan VLAN"
              },
              "tab": {
                "title": "Security"
              }
            },
            "widgets": [
              {
                "config": {
                  "fields": [
                    "timestamp",
                    "source"
                  ],
                  "units": {},
                  "show_message_row": true,
                  "show_summary": true,
                  "decorators": [],
                  "sort": [
                    {
                      "type": "pivot",
                      "field": "timestamp",
                      "direction": "Descending"
                    }
                  ]
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": "meraki_event_type:\"martian_vlan\""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "messages",
                "stream_categories": [],
                "id": "c62e0dec-744b-4fb7-8c4b-90454542836a",
                "filters": []
              },
              {
                "config": {
                  "visualization": "table",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "meraki_issue"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Total Issues"
                      },
                      "function": "count(meraki_issue)"
                    },
                    {
                      "config": {
                        "name": "Percentage of Total"
                      },
                      "function": "percentage(meraki_issue)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "pinned_columns": []
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "from": 86400,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "c10eb3e1-64a3-48d8-8916-625ec2f31fd8",
                "filters": []
              }
            ],
            "widget_mapping": {
              "c10eb3e1-64a3-48d8-8916-625ec2f31fd8": [
                "0a7358ad-70ed-49a3-bc42-b0c3283db5cb"
              ],
              "c62e0dec-744b-4fb7-8c4b-90454542836a": [
                "d13cd07d-4419-45bd-aec2-6f9b41098c30"
              ]
            },
            "positions": {
              "c10eb3e1-64a3-48d8-8916-625ec2f31fd8": {
                "col": 1,
                "row": 1,
                "height": 4,
                "width": 4
              },
              "c62e0dec-744b-4fb7-8c4b-90454542836a": {
                "col": 5,
                "row": 1,
                "height": 4,
                "width": 6
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          },
          "c650fdda-5500-4885-bf0b-43c93273e86b": {
            "selected_fields": null,
            "static_message_list_id": null,
            "titles": {
              "tab": {
                "title": "Wireless"
              },
              "widget": {
                "f8f3ebd4-9c5e-4b0c-a38d-7b66fed2a54f": "Avg Signal Strength in dB"
              }
            },
            "widgets": [
              {
                "config": {
                  "visualization": "bar",
                  "units": {},
                  "column_limit": null,
                  "event_annotation": false,
                  "row_limit": 15,
                  "row_pivots": [
                    {
                      "fields": [
                        "meraki_host"
                      ],
                      "type": "values",
                      "config": {
                        "limit": 15,
                        "skip_empty_values": true
                      }
                    }
                  ],
                  "series": [
                    {
                      "config": {
                        "name": "Signal Strength"
                      },
                      "function": "avg(meraki_signal_strength_db)"
                    },
                    {
                      "config": {
                        "name": "Best AP Signal Strength"
                      },
                      "function": "avg(meraki_best_ap_signal_strength_db)"
                    }
                  ],
                  "rollup": false,
                  "column_pivots": [],
                  "visualization_config": {
                    "barmode": "group",
                    "axis_type": "linear"
                  },
                  "formatting_settings": null,
                  "sort": []
                },
                "query": {
                  "type": "elasticsearch",
                  "query_string": ""
                },
                "timerange": {
                  "from": 300,
                  "type": "relative"
                },
                "streams": [
                  "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
                ],
                "filter": null,
                "type": "aggregation",
                "stream_categories": [],
                "id": "f8f3ebd4-9c5e-4b0c-a38d-7b66fed2a54f",
                "filters": []
              }
            ],
            "widget_mapping": {
              "f8f3ebd4-9c5e-4b0c-a38d-7b66fed2a54f": [
                "5fac8ad0-8558-463f-93e8-8b1a5fdee633"
              ]
            },
            "positions": {
              "f8f3ebd4-9c5e-4b0c-a38d-7b66fed2a54f": {
                "col": 1,
                "row": 1,
                "height": 5,
                "width": "Infinity"
              }
            },
            "formatting": {
              "highlighting": []
            },
            "display_mode_settings": {
              "positions": {}
            }
          }
        },
        "properties": [],
        "owner": "admin",
        "title": {
          "@type": "string",
          "@value": "Cisco Meraki"
        },
        "type": "DASHBOARD",
        "description": {
          "@type": "string",
          "@value": ""
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "40cca34b-ca1e-4440-8c4e-8ef64bc8c850",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - APS Association"
        },
        "description": {
          "@type": "string",
          "@value": "Parses logs for the aps_association"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - APS Association\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"type=aps_association\",\n  ignore_case: true\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"type=%{WORD:event_type}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"load='%{BASE10NUM:load}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"best_ap='%{IP:best_ap}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"best_ap_load='%{BASE10NUM:best_ap_load}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"best_ap_rssi='%{BASE10NUM:best_ap_rssi}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\n  remove_single_field(\n    field : \"meraki_IP\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2155bc02-9c43-498a-bb5f-ad6f6b5b8439",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Extract Syslog PRI"
        },
        "description": {
          "@type": "string",
          "@value": "Parses out syslog severity and facility"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Extract Syslog PRI\"\nwhen\n    has_field(\"message\")\nthen\n    let pri_value = regex(\"<(\\\\d+)>\\\\d\", to_string($message.message));\n    \n    // Convert PRI to Facility and Severity\n    let pri = to_long(pri_value[\"0\"]);\n    let facility = pri / 8;\n    let severity = pri % 8;\n    \n    let severity_text = lookup_value(\"Meraki Syslog Severity Mapping\", to_string(severity));\n    let facility_text = lookup_value(\"Meraki Facility Mapping\", to_string(facility));\n    \n    set_field(\"meraki_syslog_facility\", facility_text);\n    set_field(\"meraki_syslog_severity\", severity_text);\nend\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2ff11182-ee53-407f-b559-d2bd5bf8e97b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - syslog_priority"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - syslog_priority\"\nwhen\n  has_field(\n    field : \"meraki_syslog_priority\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_syslog_priority\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_syslog_priority\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "8944ebac-74e9-4361-b57b-430029cb1b0c",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - radio"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "f4fe1cf7-66ac-47ec-9616-6bdce6d805a5"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - radio"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Lookup table for radio"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "a6f16f00-ecd4-4417-9fed-875f4c9faa9e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - last_auth_ago"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - last_auth_ago\"\nwhen\n  has_field(\n    field : \"meraki_last_auth_ago\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\"\n  );\n  let output_1 = get_field(\n    field : \"meraki_last_auth_ago\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_last_auth_ago\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "6bda39a0-b9d3-4fbc-b04c-91876125809f",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - is_wpa"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "fda03bad-cc77-4be9-892a-eb9724508e31"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - is_wpa"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Mapping  is_wpa for Meraki"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "d0aaea18-6efb-4784-8130-5853b2fc3134",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dns_req_rtt_time"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dns_req_rtt_time\"\nwhen\n  has_field(\n    field : \"meraki_dns_req_rtt_time\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_dns_req_rtt_time\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_dns_req_rtt_time\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "f4fe1cf7-66ac-47ec-9616-6bdce6d805a5",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - radio"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - radio"
        },
        "description": {
          "@type": "string",
          "@value": "Data adapter for meraki radio"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/radio.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "b719a715-eb39-40fa-a282-152d2db2b218",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - icmp_type"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "2f5d889d-f81e-430c-b7db-64042bc2c721"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - icmp_type"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Lookup table for converting icmp_type to its description."
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "29856e44-7589-4ced-8dfd-817ab16940d2",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki Syslog Severity Mapping"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "4c426b3c-1bfa-4b89-8a00-0b92c9b05117"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - Syslog Severity Mapping"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Mapping Syslog Severity for meraki"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "f75ab07f-7712-4d6d-95ec-fd68355ecfee",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - protocol"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "2e8aa85f-eccb-4e5b-941d-d6b35f5fe0a0"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - protocol"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Lookup table for meraki protocol"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b8173945-27d2-4186-9c82-a35357a15822",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - http_resp_time"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - http_resp_time\"\nwhen\n  has_field(\n    field : \"meraki_http_resp_time\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_http_resp_time\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_http_resp_time\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "aecde056-15ea-492e-a6fa-1d21cbafc5b2",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - server"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - server\"\nwhen\n  has_field(\n    field : \"meraki_server\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_server\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_server\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2ad02961-002b-4578-bf05-b91ad4ce6966",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - syslog_ver"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - syslog_ver\"\nwhen\n  has_field(\n    field : \"meraki_syslog_ver\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_syslog_ver\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_syslog_ver\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "3e50795c-0b1b-411b-93be-b220d296b041",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - best_ap"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - best_ap\"\nwhen\n  has_field(\n    field : \"meraki_best_ap\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_best_ap\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_best_ap\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "ac3865e2-9411-43e8-a4df-a2758642a462",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dhcp_resp_time"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dhcp_resp_time\"\nwhen\n  has_field(\n    field : \"meraki_dhcp_resp_time\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_dhcp_resp_time\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_dhcp_resp_time\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "8dad1f81-8f54-48ad-b7c8-4f85a3af805c",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - is_wpa"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - is_wpa\"\nwhen\n  has_field(\n    field : \"meraki_is_wpa\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_is_wpa\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  let gl2_fragment_extractor_1742593446652 = lookup_value(\"Meraki - is_wpa\", to_string($message.\"meraki_is_wpa\"));\nset_field(\"meraki_is_wpa_description\", gl2_fragment_extractor_1742593446652);\n  let output_3 = gl2_fragment_extractor_1742593446652;\n  set_field(\n    field : \"meraki_is_wpa_description\",\n    value : output_3\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "d1449d1d-d63d-431e-b43b-85a4483bf9dd",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - duration"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - duration\"\nwhen\n  has_field(\n    field : \"meraki_duration\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_duration\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_duration\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "f524dffd-51f0-481f-9720-f3e99a9f1487",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - frame_control"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - frame_control\"\nwhen\n  has_field(\n    field : \"meraki_fc_type\"\n  )\n  AND\n  has_field(\n    field : \"meraki_fc_subtype\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_fc_type\"\n  );\n  let output_2 = get_field(\n    field : \"meraki_fc_subtype\"\n  );\n  let output_3 = to_string(\n    value : output_1\n  );\n  let output_4 = to_string(\n    value : output_2\n  );\n  let output_5 = concat(\n    first : output_3,\n    second : \"_\"\n  );\n  let output_6 = concat(\n    first : output_5,\n    second : output_4\n  );\n  set_field(\n    field : \"meraki_fc_combined\",\n    value : output_6\n  );\n  let gl2_fragment_extractor_1743194726951 = lookup_value(\"Meraki - FC Combined\", to_string($message.\"meraki_fc_combined\"));\nset_field(\"meraki_frame_control\", gl2_fragment_extractor_1743194726951);\n  let output_7 = gl2_fragment_extractor_1743194726951;\n  set_field(\n    field : \"meraki_frame_control\",\n    value : output_7\n  );\n  remove_single_field(\n    field : \"meraki_fc_combined\"\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "3f97bd6d-dbe7-4612-a8be-99e6b0bdc879",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - original_server_ip"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - original_server_ip\"\nwhen\n  has_field(\n    field : \"meraki_original_server_ip\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_original_server_ip\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_original_server_ip\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "194cace5-d332-45b0-9217-15983d7c2b03",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - best_ap_rssi"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - best_ap_rssi\"\nwhen\n  has_field(\n    field : \"meraki_best_ap_rssi\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_best_ap_rssi\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_best_ap_rssi\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "28d92943-031c-4af3-b28a-3bcb9c54055c",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - channel"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - channel\"\nwhen\n  has_field(\n    field : \"meraki_channel\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_channel\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_channel\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "3e6c8524-192a-4926-bf66-c225b821c3b2",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - fc_type"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - fc_type\"\nwhen\n  has_field(\n    field : \"meraki_fc_type\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\"\n  );\n  let output_1 = get_field(\n    field : \"meraki_fc_type\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_fc_type\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "b2162c3e-3503-4546-9500-b240f07b5568",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - switch_port"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - switch_port\"\nwhen\n  has_field(\n    field : \"meraki_switch_port\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_switch_port\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_switch_port\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "52a07b0f-be29-44de-872b-2b9744258a21",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - band"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "2ddb01ae-bc6d-477d-b74f-e967353c7f3f"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - band"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Lookup table for wireless band"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "44acc418-909c-4fbb-bda0-7c7a635bb29e",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - priority"
        },
        "description": {
          "@type": "string",
          "@value": "Converts snort priority to description."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - priority\"\nwhen\n  has_field(\n    field : \"meraki_priority\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_priority\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_priority\",\n    value : output_2\n  );\n  let gl2_fragment_extractor_1743831166804 = lookup_value(\"Meraki - priority\", to_string($message.\"meraki_priority\"));\nset_field(\"meraki_priority_description\", gl2_fragment_extractor_1743831166804);\n  let output_3 = gl2_fragment_extractor_1743831166804;\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2bd327dc-5b65-4f71-b426-7a9c40854fd0",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Flows"
        },
        "description": {
          "@type": "string",
          "@value": " Parses out flows logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Flows\"\nwhen\n  grok(\n  value: to_string($message.\"message\"),\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} flows\"\n).matches == true\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category} %{WORD:action}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"src=%{IP:src_ip}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dst=%{IP:dst_ip}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"mac=%{COMMONMAC:mac_address}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"protocol=%{WORD:protocol}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"protocol=%{INT:protocol_number}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"sport=%{INT:src_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dport=%{INT:dst_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"type=%{BASE10NUM:icmp_type}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "d6b3a07b-49bc-4404-864d-f1725d2808da",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - IP Flow"
        },
        "description": {
          "@type": "string",
          "@value": "Parses logs containing ip_flow"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - IP Flow\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"ip_flow\"\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"src=%{IP:src_ip}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dst=%{IP:dst_ip}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"protocol=%{WORD:protocol}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"sport=%{INT:src_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dport=%{INT:dst_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"translated_src_ip=%{IP:translated_src_ip}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"translated_port=%{INT:translated_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "d0880fd2-93e0-437f-841d-3d9eeaa8732a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - arp_src"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - arp_src\"\nwhen\n  has_field(\n    field : \"meraki_arp_src\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\"\n  );\n  let output_1 = get_field(\n    field : \"meraki_arp_src\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_arp_src\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "7cd9854a-802d-4af8-b1ea-8210fd83e12f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - Route Connection Change"
        },
        "description": {
          "@type": "string",
          "@value": "Parses route connection change logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - Route Connection Change\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"route_connection_change\"\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category} type=%{DATA:event_type} peer_type='%{DATA:peer_type}' \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"peer='%{IP:peer}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"connection_status='%{WORD:connection_status}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "4afab4a9-db69-4e1c-8f23-a3f792185af0",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - STP Role Change"
        },
        "description": {
          "@type": "string",
          "@value": "Parses event logs referencing STP role changes. "
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - STP Role Change\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"changed STP role\",\n  ignore_case: true\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"Port %{BASE10NUM:switch_port} changed STP role from %{WORD:old_stp_role} to %{WORD:new_stp_role}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  set_field(\n    field : \"issue\",\n    value : \"STP Role Change\",\n    prefix : \"meraki_\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "dbcc2b17-c5dd-4637-86b9-cc612455930a",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - translated_port"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - translated_port\"\nwhen\n  has_field(\n    field : \"meraki_translated_port\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_translated_port\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_translated_port\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "8bcdd789-7bfb-408f-8e1d-ac18c1230bea",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - urls_url_ip6"
        },
        "description": {
          "@type": "string",
          "@value": "Converts urls of an ipv6 address to the received url from original message."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - urls_url_ip6\"\nwhen\n  has_field(\n    field : \"meraki_url_ip6\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_url\"\n  );\n  let output_2 = to_string(\n    value : output_1\n  );\n  let output_3 = get_field(\n    field : \"meraki_url_ip6\"\n  );\n  let output_4 = to_string(\n    value : output_3\n  );\n  let output_5 = concat(\n    first : output_2,\n    second : \"[\"\n  );\n  let output_6 = concat(\n    first : output_5,\n    second : output_4\n  );\n  let output_7 = concat(\n    first : output_6,\n    second : \"]\"\n  );\n  let output_8 = get_field(\n    field : \"meraki_url_port\"\n  );\n  let output_9 = to_string(\n    value : output_8\n  );\n  let output_10 = concat(\n    first : output_7,\n    second : \":\"\n  );\n  let output_11 = concat(\n    first : output_10,\n    second : output_9\n  );\n  let output_12 = get_field(\n    field : \"meraki_url_path\"\n  );\n  let output_13 = to_string(\n    value : output_12\n  );\n  let output_14 = concat(\n    first : output_11,\n    second : output_13\n  );\n  set_field(\n    field : \"meraki_url\",\n    value : output_14\n  );\n  remove_single_field(\n    field : \"meraki_url_ip6\"\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "de6f6189-bff7-4f18-b11a-d101c1e0874f",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "meraki-priority"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - priority"
        },
        "description": {
          "@type": "string",
          "@value": "Data adapter for priority"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/snort_priority.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "437fbe75-ee64-437c-baa4-2494eedfcaec",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - last_known_client_ip"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - last_known_client_ip\"\nwhen\n  has_field(\n    field : \"meraki_last_known_client_ip\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\"\n  );\n  let output_1 = get_field(\n    field : \"meraki_last_known_client_ip\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_last_known_client_ip\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "868c336c-e0de-4ad5-897c-d161265995f6",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - dns_server"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - dns_server\"\nwhen\n  has_field(\n    field : \"meraki_dns_server\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_dns_server\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_dns_server\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "39975b04-4586-4e07-afa5-e0a998de4ad3",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - auth_neg_dur"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - auth_neg_dur\"\nwhen\n  has_field(\n    field : \"meraki_auth_neg_dur\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_auth_neg_dur\"\n  );\n  let output_2 = to_double(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_auth_neg_dur\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "acc18d1e-8de6-4428-b5c3-cd0dfdcff38b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - radio"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - radio\"\nwhen\n  has_field(\n    field : \"meraki_radio\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_radio\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_radio\",\n    value : output_2\n  );\n  let gl2_fragment_extractor_1743547759943 = lookup_value(\"Meraki - radio\", to_string($message.\"meraki_radio\"));\nset_field(\"meraki_radio_description\", gl2_fragment_extractor_1743547759943);\n  let output_3 = gl2_fragment_extractor_1743547759943;\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "2f5d889d-f81e-430c-b7db-64042bc2c721",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - icmp_type"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - icmp_type"
        },
        "description": {
          "@type": "string",
          "@value": "Data adapter for meraki icmp type"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/icmp_type.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "stream",
        "version": "1"
      },
      "id": "47a2234b-bac7-4c02-9a87-fe2922cad3c1",
      "data": {
        "alarm_callbacks": [],
        "outputs": [],
        "remove_matches": {
          "@type": "boolean",
          "@value": true
        },
        "title": {
          "@type": "string",
          "@value": "Cisco Meraki"
        },
        "stream_rules": [
          {
            "type": {
              "@type": "string",
              "@value": "MATCH_INPUT"
            },
            "field": {
              "@type": "string",
              "@value": ""
            },
            "value": {
              "@type": "string",
              "@value": "67d327bb50f11e068c0b51eb"
            },
            "inverted": {
              "@type": "boolean",
              "@value": false
            },
            "description": {
              "@type": "string",
              "@value": ""
            }
          }
        ],
        "alert_conditions": [],
        "matching_type": {
          "@type": "string",
          "@value": "AND"
        },
        "disabled": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "Stream for containing all Meraki Logs"
        },
        "default_stream": {
          "@type": "boolean",
          "@value": false
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "5d622d2c-015f-479b-a8f8-fe6fcd025a5b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - peer"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - peer\"\nwhen\n  has_field(\n    field : \"meraki_peer\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_peer\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_peer\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "fddb005e-62a2-4d35-ae33-48a05ff049bb",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Firewall"
        },
        "description": {
          "@type": "string",
          "@value": "Parses out firewall logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Firewall\"\nwhen\n  grok(\n  value: to_string($message.\"message\"),\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} firewall\"\n).matches == true\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"src=%{IP:src_ip}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dst=%{IP:dst_ip}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"protocol=%{WORD:protocol}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"mac=%{COMMONMAC:mac_address}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"sport=%{INT:src_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dport=%{INT:dst_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"pattern: %{GREEDYDATA:pattern}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "8601db47-a9ab-4619-92ce-0e73337dfbdd",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - server_port"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - server_port\"\nwhen\n  has_field(\n    field : \"meraki_server_port\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_server_port\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_server_port\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "event_definition",
        "version": "1"
      },
      "id": "bfd20f5f-ba62-40f4-bb95-c2382b1ecb2c",
      "data": {
        "field_spec": {},
        "config": {
          "query_parameters": [],
          "search_within_ms": 300000,
          "query": {
            "@type": "string",
            "@value": "_exists_:meraki_dns_req_rtt_time"
          },
          "cron_expression": null,
          "cron_timezone": null,
          "use_cron_scheduling": false,
          "streams": [
            "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
          ],
          "execute_every_ms": 300000,
          "event_limit": 100,
          "group_by": [
            "meraki_dns_req_rtt_time"
          ],
          "series": [
            {
              "type": "avg",
              "id": "avg-meraki_dns_req_rtt_time",
              "field": "meraki_dns_req_rtt_time",
              "whole_number": false
            }
          ],
          "conditions": {
            "expression": {
              "expr": ">=",
              "left": {
                "expr": "number-ref",
                "ref": "avg-meraki_dns_req_rtt_time"
              },
              "right": {
                "expr": "number",
                "value": 0.25
              }
            }
          },
          "type": "aggregation-v1",
          "stream_categories": [],
          "filters": []
        },
        "priority": {
          "@type": "integer",
          "@value": 2
        },
        "notifications": [],
        "remediation_steps": null,
        "matched_at": "2025-04-10T18:19:59.502Z",
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "notification_settings": {
          "grace_period_ms": 300000,
          "backlog_size": 0
        },
        "updated_at": "2025-03-28T18:44:59.500Z",
        "title": {
          "@type": "string",
          "@value": "Meraki - High DNS Request Round-Trip Times"
        },
        "is_scheduled": {
          "@type": "boolean",
          "@value": true
        },
        "key_spec": [],
        "storage": [
          {
            "type": "persist-to-streams-v1",
            "streams": [
              "000000000000000000000002"
            ]
          }
        ],
        "alert": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "Alerts based on high average DNS Request Round-Trip Times."
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_adapter",
        "version": "1"
      },
      "id": "2ddb01ae-bc6d-477d-b74f-e967353c7f3f",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - band"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - band"
        },
        "description": {
          "@type": "string",
          "@value": "Data adapter for wireless band"
        },
        "configuration": {
          "value_column": {
            "@type": "string",
            "@value": "value"
          },
          "path": {
            "@type": "string",
            "@value": "/etc/graylog/files/band.csv"
          },
          "cidr_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "separator": {
            "@type": "string",
            "@value": ","
          },
          "quotechar": {
            "@type": "string",
            "@value": "\""
          },
          "key_column": {
            "@type": "string",
            "@value": "key"
          },
          "case_insensitive_lookup": {
            "@type": "boolean",
            "@value": false
          },
          "type": {
            "@type": "string",
            "@value": "csvfile"
          },
          "check_interval": {
            "@type": "long",
            "@value": 60
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_table",
        "version": "1"
      },
      "id": "4e81f21d-c6c6-4c45-9c34-3b2d3d9440be",
      "data": {
        "default_single_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "cache_name": {
          "@type": "string",
          "@value": "a2e54b61-2b4f-4498-8636-0d8e477d3062"
        },
        "name": {
          "@type": "string",
          "@value": "Meraki - reason"
        },
        "default_multi_value_type": {
          "@type": "string",
          "@value": "NULL"
        },
        "default_multi_value": {
          "@type": "string",
          "@value": ""
        },
        "data_adapter_name": {
          "@type": "string",
          "@value": "ec012a41-9c14-49d7-8142-3cb7b0c64e1f"
        },
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "title": {
          "@type": "string",
          "@value": "Meraki - reason"
        },
        "default_single_value": {
          "@type": "string",
          "@value": ""
        },
        "description": {
          "@type": "string",
          "@value": "Lookup table for Reason"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "event_definition",
        "version": "1"
      },
      "id": "b8e65366-eb3c-4a88-911b-8b01e76b9b24",
      "data": {
        "field_spec": {},
        "config": {
          "query_parameters": [],
          "search_within_ms": 300000,
          "query": {
            "@type": "string",
            "@value": "meraki_syslog_severity:Emergency"
          },
          "cron_expression": null,
          "cron_timezone": null,
          "use_cron_scheduling": false,
          "streams": [
            "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
          ],
          "execute_every_ms": 300000,
          "event_limit": 1,
          "group_by": [],
          "series": [],
          "conditions": {
            "expression": null
          },
          "type": "aggregation-v1",
          "stream_categories": [],
          "filters": []
        },
        "priority": {
          "@type": "integer",
          "@value": 3
        },
        "notifications": [],
        "remediation_steps": null,
        "matched_at": null,
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "notification_settings": {
          "grace_period_ms": 300000,
          "backlog_size": 0
        },
        "updated_at": "2025-04-07T22:58:57.273Z",
        "title": {
          "@type": "string",
          "@value": "Meraki - Syslog Severity"
        },
        "is_scheduled": {
          "@type": "boolean",
          "@value": true
        },
        "key_spec": [],
        "storage": [
          {
            "type": "persist-to-streams-v1",
            "streams": [
              "000000000000000000000002"
            ]
          }
        ],
        "alert": {
          "@type": "boolean",
          "@value": false
        },
        "description": {
          "@type": "string",
          "@value": "Checks for any Emergency level Syslog Messages."
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "1b8ebb8c-7e43-48ec-a360-c4ddbba83956",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - UNIX Event Timestamp Conversion with Timezone"
        },
        "description": {
          "@type": "string",
          "@value": "Converts the security_event timestamp to human readable."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - UNIX Event Timestamp Conversion with Timezone\"\nwhen\n  has_field(\"meraki_event_timestamp\")\nthen\n  // Step 1: Get raw epoch value as string\n  let raw_epoch_str = to_string(get_field(\"meraki_event_timestamp\"));\n  //set_field(\"debug_raw_epoch_str\", raw_epoch_str);\n\n  // Step 2: Convert to floating-point number to handle decimals\n  let raw_epoch = to_double(raw_epoch_str);\n  //set_field(\"debug_raw_epoch\", raw_epoch);\n\n  // Step 3: Drop the decimal part and convert to whole seconds (round down)\n  let epoch_seconds = to_long(raw_epoch);  // Dropping the fractional part\n  //set_field(\"debug_epoch_seconds\", epoch_seconds);\n\n  // Step 4: Convert the epoch seconds to milliseconds\n  let epoch_ms = epoch_seconds * 1000;  // Convert to milliseconds\n  //set_field(\"debug_epoch_ms\", epoch_ms);\n\n  // Step 5: Use parse_unix_milliseconds to convert the epoch timestamp (milliseconds) to a date\n  let converted_date = parse_unix_milliseconds(epoch_ms, \"America/Los_Angeles\");\n // set_field(\"debug_converted_date_tz\", converted_date);\n\n  // Step 6: Store the correctly parsed and timezone-adjusted timestamp\n  set_field(\"meraki_event_timestamp_converted\", converted_date);\nend\n"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline",
        "version": "1"
      },
      "id": "cbbf4db1-0a61-4e45-a0c3-5032eb4b9595",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Cisco Meraki"
        },
        "description": {
          "@type": "string",
          "@value": ""
        },
        "source": {
          "@type": "string",
          "@value": "pipeline \"Cisco Meraki\"\nstage 1 match either\nrule \"Meraki - aid\"\nrule \"Meraki - arp_resp_time\"\nrule \"Meraki - arp_src\"\nrule \"Meraki - auth_neg_dur\"\nrule \"Meraki - band\"\nrule \"Meraki - channel\"\nrule \"Meraki - dhcp_ip\"\nrule \"Meraki - dhcp_lease_completed\"\nrule \"Meraki - dhcp_resp_time\"\nrule \"Meraki - dhcp_server\"\nrule \"Meraki - dns_req_rtt_time\"\nrule \"Meraki - dns_resp_time\"\nrule \"Meraki - dns_server\"\nrule \"Meraki - dst_ip\"\nrule \"Meraki - dst_port\"\nrule \"Meraki - duration\"\nrule \"Meraki - epoch\"\nrule \"Meraki - fc_subtype\"\nrule \"Meraki - fc_type\"\nrule \"Meraki - full_conn_time\"\nrule \"Meraki - http_resp_time\"\nrule \"Meraki - ip_resp_time\"\nrule \"Meraki - ip_src\"\nrule \"Meraki - is_wpa\"\nrule \"Meraki - last_auth_ago\"\nrule \"Meraki - last_known_client_ip\"\nrule \"Meraki - radio\"\nrule \"Meraki - rssi\"\nrule \"Meraki - src_ip\"\nrule \"Meraki - src_port\"\nrule \"Meraki - syslog_priority\"\nrule \"Meraki - syslog_ver\"\nrule \"Meraki - translated_port\"\nrule \"Meraki - translated_src_ip\"\nrule \"Meraki - vap\"\nrule \"Meraki - UNIX Epoch Conversion with Timezone\"\nrule \"Meraki - last_known_client_ip6\"\nrule \"Meraki - client_ip\"\nrule \"Meraki - server\"\nrule \"Meraki - server_port\"\nrule \"Meraki - switch_port\"\nrule \"Meraki - reason\"\nrule \"Meraki - vlan\"\nrule \"Meraki - load\"\nrule \"Meraki - best_ap\"\nrule \"Meraki - best_ap_load\"\nrule \"Meraki - original_server_ip\"\nrule \"Meraki - server_ip\"\nrule \"Meraki - peer\"\nrule \"Meraki - icmp_type\"\nrule \"Meraki - icmp6_type\"\nrule \"Meraki - best_ap_rssi\"\nrule \"Meraki - priority\"\nrule \"Meraki - UNIX Event Timestamp Conversion with Timezone\"\nstage 2 match either\nrule \"Meraki - urls_url_ip6\"\nrule \"Meraki - protocol\"\nrule \"Meraki - frame_control\"\nrule \"Meraki - rssi_signal_strength \"\nrule \"Meraki - best_ap_rssi_signal_strength \"\nstage 0 match either\nrule \"Meraki - Extract Syslog PRI\"\nrule \"Meraki - Airmarshal Events\"\nrule \"Meraki - Events\"\nrule \"Meraki - Firewall\"\nrule \"Meraki - Flows\"\nrule \"Meraki - IP Flow\"\nrule \"Meraki - URLS\"\nrule \"Meraki - Events - Content Filtering\"\nrule \"Meraki - Events - DHCP No Offers\"\nrule \"Meraki - Events - FIPS Event\"\nrule \"Meraki - Events - Port Status Change\"\nrule \"Meraki - Events - Route Connection Change\"\nrule \"Meraki - Events - STP Role Change\"\nrule \"Meraki - Events - Two MACs Same IP\"\nrule \"Meraki - Events - APS Association\"\nrule \"Meraki - MAC Flap Detected\"\nrule \"Meraki - IDS Alerts\"\nrule \"Meraki - Security Event\"\nrule \"Meraki - Events - Blocked DHCP Server\"\nend"
        },
        "connected_streams": [
          {
            "@type": "string",
            "@value": "47a2234b-bac7-4c02-9a87-fe2922cad3c1"
          }
        ]
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "9e8d7263-ef65-4f86-a103-4707f5d6f867",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - last_known_client_ip6"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - last_known_client_ip6\"\nwhen\n  has_field(\n    field : \"meraki_last_known_client_ip6\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_last_known_client_ip6\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_last_known_client_ip6\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "44405719-99f5-476f-a6f2-8cf03740d4bd",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - Blocked DHCP Server"
        },
        "description": {
          "@type": "string",
          "@value": "Parses logs for Blocked DHCP Servers"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - Blocked DHCP Server\"\nwhen\n  grok(\n  value: to_string($message.\"message\"),\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category} Blocked DHCP server \"\n).matches == true\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category} Blocked DHCP server response from %{COMMONMAC:blocked_dhcp_mac} on VLAN %{BASE10NUM:vlan}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  set_field(\n    field : \"issue\",\n    value : \"Blocked DHCP Server\",\n    prefix : \"meraki_\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "f57d699a-04d4-42d9-b8e8-19d773492825",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - src_port"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - src_port\"\nwhen\n  has_field(\n    field : \"meraki_src_port\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_src_port\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_src_port\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "52d58cfa-4cba-4732-8d69-e60bfe5fce1f",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - best_ap_rssi_signal_strength "
        },
        "description": {
          "@type": "string",
          "@value": "Converts best_ap_rssi to its Signal Strength in dB"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - best_ap_rssi_signal_strength \"\nwhen\n    has_field(\"meraki_best_ap_rssi\")\nthen\n  let rssi = to_long($message.meraki_best_ap_rssi);\n  let signal_strength = rssi - 95;\n  set_field(\"meraki_best_ap_signal_strength_db\", signal_strength);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "73bc935b-f42b-48bb-bb16-8bd4695d4bd7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - translated_src_ip"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - translated_src_ip\"\nwhen\n  has_field(\n    field : \"meraki_translated_src_ip\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_translated_src_ip\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_translated_src_ip\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "fdc427f3-cce9-4efb-ab82-72de4a3f97e7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - URLS"
        },
        "description": {
          "@type": "string",
          "@value": "Parses URLS logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - URLS\"\nwhen\n  grok(\n  value: to_string($message.\"message\"),\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} urls\"\n).matches == true\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"src=%{IP:src_ip}:%{INT:src_port}|src=\\\\[%{IPV6:src_ip}\\\\]:%{INT:src_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dst=%{IP:dst_ip}:%{INT:dst_port}|dst=\\\\[%{IPV6:dst_ip}\\\\]:%{INT:dst_port}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"mac=%{COMMONMAC:mac_address}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"request: %{WORD:request} %{URI:url}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"request: %{WORD:http_method} %{URIPROTO:url_protocol}://\\\\[%{IPV6:url_ip6}\\\\]:(%{INT:url_port})%{URIPATH:url_path}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"agent='%{DATA:agent}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  rename_field(\n    old_field : \"meraki_HOSTNAME\",\n    new_field : \"meraki_url_hostname\"\n  );\n  rename_field(\n    old_field : \"meraki_IPORHOST\",\n    new_field : \"meraki_url_iporhost\"\n  );\n  rename_field(\n    old_field : \"meraki_URIHOST\",\n    new_field : \"meraki_url_urihost\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPATH\",\n    new_field : \"meraki_url_path\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPATHPARAM\",\n    new_field : \"meraki_url_uripathparam\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPROTO\",\n    new_field : \"meraki_url_protocol\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPARAM\",\n    new_field : \"meraki_url_uriparam\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\n  remove_single_field(\n    field : \"meraki_IP\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "31c7ef25-7ebb-4eca-93fa-51f8e6695207",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - MAC Flap Detected"
        },
        "description": {
          "@type": "string",
          "@value": "Parses logs for MAC flap detections"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - MAC Flap Detected\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"mac_flap_detected\"\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  set_field(\n    field : \"issue\",\n    value : \"MAC Flap Detected\",\n    prefix : \"meraki_\"\n  );\n  let gl2_fragment_grok_results = grok(\n  pattern: \"mac='%{COMMONMAC:mac_address}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"vlan='%{BASE10NUM:vlan}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"port='%{DATA:port}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "91456366-4dc8-45f6-8903-319eb9610d5d",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - src_ip"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - src_ip\"\nwhen\n  has_field(\n    field : \"meraki_src_ip\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_src_ip\"\n  );\n  let output_2 = to_ip(\n    ip : output_1\n  );\n  set_field(\n    field : \"meraki_src_ip\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "0cafc95b-faff-4d8f-8da9-ba4ee0000f71",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events"
        },
        "description": {
          "@type": "string",
          "@value": "Parses out meraki event logs"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events\"\nwhen\n  grok(\n  value: to_string($message.\"message\"),\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoc} %{DATA:host} events\"\n).matches == true\n  AND\n  ! contains(\n  value: to_string($message.\"message\"),\n  search: \"fips_event\"\n)\n  AND\n  ! contains(\n  value: to_string($message.\"message\"),\n  search: \"aps_association\",\n  ignore_case: true\n)\n  AND\n  ! contains(\n  value: to_string($message.\"message\"),\n  search: \"Blocked DHCP server\"\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"type=%{WORD:event_type}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"type='%{WORD:action_taken}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"radio='%{BASE10NUM:radio}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"vap='%{BASE10NUM:vap}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"client_mac='%{COMMONMAC:client_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"band='%{BASE10NUM:band}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"channel='%{BASE10NUM:channel}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"da_vendor='%{WORD:da_vendor}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"duration='%{BASE10NUM:duration}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"auth_neg_dur='%{BASE10NUM:auth_neg_dur}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"last_auth_ago='%{BASE10NUM:last_auth_ago}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"is_wpa='%{BASE10NUM:is_wpa}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"full_conn='%{BASE10NUM:full_conn_time}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"ip_resp='%{BASE10NUM:ip_resp_time}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"ip_src='%{IP:src_ip}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"arp_resp='%{BASE10NUM:arp_resp_time}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"arp_src='%{IP:arp_src}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dns_server='%{IP:dns_server}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dns_req_rtt='%{BASE10NUM:dns_req_rtt_time}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dns_resp='%{BASE10NUM:dns_resp_time}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"aid='%{BASE10NUM:aid}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"group='%{DATA:group}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"attr='%{DATA:attr}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"instigator='%{DATA:instigator}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dhcp_lease_completed='%{BASE10NUM:dhcp_lease_completed}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dhcp_ip='%{IP:dhcp_ip}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dhcp_server='%{IP:dhcp_server}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dhcp_server_mac='%{COMMONMAC:dhcp_server_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dhcp_resp='%{BASE10NUM:dhcp_resp_time}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"last_known_client_ip='%{IPV4:last_known_client_ip}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"rssi='%{BASE10NUM:rssi}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"http_resp='%{BASE10NUM:http_resp_time}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"ssid='%{DATA:ssid}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"bssid='%{DATA:bssid}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"src='%{IP:src_ip}'|src='%{COMMONMAC:src_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dst='%{DATA:dst_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"wired_mac='%{DATA:wired_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"vlan_id='%{DATA:vlan_id}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"fc_type='%{BASE10NUM:fc_type}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"fc_subtype='%{BASE10NUM:fc_subtype}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"reason='%{DATA:reason}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"last_known_client_ip6='%{IPV6:last_known_client_ip6}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"da_reason='%{BASE10NUM:da_reason}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"da_subreason='%{BASE10NUM:da_subreason}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"(?i)vlan='%{BASE10NUM:vlan}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"MAC='%{COMMONMAC:mac_address}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"port='%{DATA:port}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"(?i)client='%{IP:client_ip}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"(?i)details='%{DATA:details}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"summary='%{DATA:summary}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"vpn_type='%{DATA:vpn_type}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"connectivity='%{DATA:connectivity}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"load='%{BASE10NUM:load}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"original_server_ip='%{IP:original_server_ip}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"original_server_mac='%{COMMONMAC:original_server_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"server_ip='%{IP:server_ip}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"server_mac='%{COMMONMAC:server_mac}'\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\n  remove_single_field(\n    field : \"meraki_IP\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "fba04cbd-020e-42f3-93f0-3e63c0435179",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - fc_subtype"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - fc_subtype\"\nwhen\n  has_field(\n    field : \"meraki_fc_subtype\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_fc_subtype\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_fc_subtype\",\n    value : output_2\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "3126b087-e36f-405b-a2b9-9e5e3ce8ebc2",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - band"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - band\"\nwhen\n  has_field(\n    field : \"meraki_band\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_band\"\n  );\n  let output_2 = to_long(\n    value : output_1\n  );\n  let gl2_fragment_extractor_1742593446652 = lookup_value(\"Meraki - band\", to_string($message.\"meraki_band\"));\nset_field(\"meraki_band_description\", gl2_fragment_extractor_1742593446652);\n  let output_3 = gl2_fragment_extractor_1742593446652;\n  set_field(\n    field : \"meraki_band_description\",\n    value : output_3\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "f9ae9137-0732-46c0-83b3-0c1f6e1f2ff7",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - epoch"
        },
        "description": {
          "@type": "string",
          "@value": "Converts specified Field to correct type."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - epoch\"\nwhen\n  has_field(\n    field : \"meraki_epoch\"\n  )\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let output_1 = get_field(\n    field : \"meraki_epoch\"\n  );\n  let output_2 = to_string(\n    value : output_1\n  );\n  set_field(\n    field : \"meraki_epoch\",\n    value : output_1\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "15839381-6b78-4f61-b283-017bd168a370",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Events - DHCP No Offers"
        },
        "description": {
          "@type": "string",
          "@value": "Parses event for no dhcp offers to a mac address"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Events - DHCP No Offers\"\nwhen\n  grok(\n  value: to_string($message.\"message\"),\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category} (?i)dhcp\"\n).matches == true\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{WORD:category}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"(?i)dhcp no offers for mac %{COMMONMAC:mac_address}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  set_field(\n    field : \"issue\",\n    value : \"No DHCP Offers\",\n    prefix : \"meraki_\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "2034a0b5-160a-4a84-a9df-ba0c9377006b",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - reason"
        },
        "description": {
          "@type": "string",
          "@value": "Converts disassociation codes to human readable (802.11 Dissociation Codes)"
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - reason\"\nwhen\n  has_field(\n    field : \"meraki_reason\"\n  )\n  AND\n  contains(\n  value: to_string($message.\"meraki_event_type\"),\n  search: \"disassociation\"\n)\nthen\n  route_to_stream(\n    name : \"Field Type Conversion\",\n    remove_from_default : true\n  );\n  let gl2_fragment_grok_results = grok(\n  pattern: \"%{BASE10NUM:reason}\",\n  value: to_string($message.\"meraki_reason\"),\n  only_named_captures: true\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\",\n  suffix: \"_num\"\n);\n  let gl2_fragment_extractor_1743831166804 = lookup_value(\"Meraki - reason\", to_string($message.\"meraki_reason_num\"));\nset_field(\"meraki_reason_description\", gl2_fragment_extractor_1743831166804);\n  let output_1 = gl2_fragment_extractor_1743831166804;\n  remove_single_field(\n    field : \"meraki_reason_num\"\n  );\n  remove_from_stream(\n    name : \"Field Type Conversion\"\n  );\n  route_to_stream(\n    name : \"Cisco Meraki\",\n    remove_from_default : true\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "pipeline_rule",
        "version": "1"
      },
      "id": "11e79bf7-09bd-454b-9434-9efa518a6469",
      "data": {
        "title": {
          "@type": "string",
          "@value": "Meraki - Security Event"
        },
        "description": {
          "@type": "string",
          "@value": "Parses Security Event logs."
        },
        "source": {
          "@type": "string",
          "@value": "rule \"Meraki - Security Event\"\nwhen\n  contains(\n  value: to_string($message.\"message\"),\n  search: \"security_event\",\n  ignore_case: true\n)\nthen\n  let gl2_fragment_grok_results = grok(\n  pattern: \"<%{BASE10NUM:syslog_priority}>%{BASE10NUM:syslog_ver} %{BASE10NUM:epoch} %{DATA:host} %{DATA:category} %{DATA:subcategory} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  set_field(\n    field : \"issue\",\n    value : \"Security Event\",\n    prefix : \"meraki_\"\n  );\n  let gl2_fragment_grok_results = grok(\n  pattern: \"signature=%{DATA:signature} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"priority=%{BASE10NUM:priority} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"timestamp=%{BASE10NUM:event_timestamp} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dhost=%{COMMONMAC:mac_address} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"direction=%{WORD:direction} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"protocol=%{DATA:protocol} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"src=%{IPV4:src_ip}:%{INT:src_port} |src=%{IPV6:src_ip}:%{INT:src_port} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"dst=%{IPV4:dst_ip}:%{INT:dst_port} |src=%{IPV6:dst_ip}:%{INT:dst_port} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"decision=%{WORD:decision} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"action=%{WORD:action}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"message: %{GREEDYDATA:message} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"mac=%{COMMONMAC:mac_address} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"name='%{DATA:file_name}' |name=%{DATA:file_name} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"sha256=%{DATA:sha256} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"disposition=%{WORD:disposition}\",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  let gl2_fragment_grok_results = grok(\n  pattern: \"url=%{URI:url} \",\n  value: to_string($message.\"message\")\n);\nset_fields(\n  fields: gl2_fragment_grok_results,\n  prefix: \"meraki_\"\n);\n  rename_field(\n    old_field : \"meraki_HOSTNAME\",\n    new_field : \"meraki_url_hostname\"\n  );\n  rename_field(\n    old_field : \"meraki_IPORHOST\",\n    new_field : \"meraki_url_iporhost\"\n  );\n  rename_field(\n    old_field : \"meraki_URIHOST\",\n    new_field : \"meraki_url_urihost\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPATH\",\n    new_field : \"meraki_url_uripath\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPATHPARAM\",\n    new_field : \"meraki_url_uripathparam\"\n  );\n  rename_field(\n    old_field : \"meraki_URIPROTO\",\n    new_field : \"meraki_url_uriproto\"\n  );\n  remove_single_field(\n    field : \"meraki_IP\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV4\"\n  );\n  remove_single_field(\n    field : \"meraki_IPV6\"\n  );\nend"
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    },
    {
      "v": "1",
      "type": {
        "name": "lookup_cache",
        "version": "1"
      },
      "id": "a2e54b61-2b4f-4498-8636-0d8e477d3062",
      "data": {
        "_scope": {
          "@type": "string",
          "@value": "DEFAULT"
        },
        "name": {
          "@type": "string",
          "@value": "generic-cache"
        },
        "title": {
          "@type": "string",
          "@value": "Generic Cache"
        },
        "description": {
          "@type": "string",
          "@value": "Generic, local only in memory cache"
        },
        "configuration": {
          "type": {
            "@type": "string",
            "@value": "guava_cache"
          },
          "max_size": {
            "@type": "integer",
            "@value": 1000
          },
          "expire_after_access": {
            "@type": "long",
            "@value": 60
          },
          "expire_after_access_unit": {
            "@type": "string",
            "@value": "SECONDS"
          },
          "expire_after_write": {
            "@type": "long",
            "@value": 0
          },
          "ignore_null": {
            "@type": "boolean",
            "@value": false
          }
        }
      },
      "constraints": [
        {
          "type": "server-version",
          "version": ">=6.1.10+a308be3"
        }
      ]
    }
  ]
}